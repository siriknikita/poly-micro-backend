# Poly Micro Manager Backend

Це бекенд-компонент застосунку Poly Micro Manager. Він надає API для керування мікросервісами, моніторингу логів, запуску тестів та інших функцій.

## Структура проєкту

Бекенд організовано в кілька директорій, кожна з яких має окрему відповідальність:

### Файли в корені

- `run.py` — Головна точка входу до застосунку. Запускає сервер FastAPI.
- `logging-ai-agent.py` — Скрипт для аналізу логів за допомогою ШІ.
- `run_logging_demo.py` — Демонстраційний скрипт для функціоналу логування.
- `setup_demo.py` — Скрипт для створення демонстраційних даних.

### Директорія `/app`

Основний код застосунку міститься в директорії `/app`, яка організована наступним чином:

#### `/app/api`

Містить маршрути API та визначення ендпоінтів:

- `dependencies.py` — Визначає ін’єкцію залежностей для маршрутів API.
- Директорія `/routes`:
  - `__init__.py` — Ініціалізаційний файл пакету.
  - `auth.py` — Ендпоінти для автентифікації (логін, реєстрація).
  - `logs.py` — Ендпоінти для доступу до логів та їх управління.
  - `metrics.py` — Ендпоінти для отримання метрик.
  - `projects.py` — Ендпоінти для управління проєктами (CRUD).
  - `questions.py` — Ендпоінти для подання та отримання запитань.
  - `service_logs.py` — Ендпоінти для логів конкретних сервісів.
  - `services.py` — Ендпоінти для управління сервісами (CRUD).
  - `tests.py` — Ендпоінти для запуску тестів та перегляду результатів.

#### `/app/core`

Основна логіка та конфігурація:

- `auth.py` — Логіка автентифікації та допоміжні функції.
- `cache.py` — Механізми кешування.
- `config.py` — Налаштування застосунку.
- `enum_compat.py` — Утиліти для сумісності з Enum.
- `jwt_generator.py` — Генерація та валідація JWT токенів.
- `sample_data.py` — Тестові дані для розробки.

#### `/app/db`

З’єднання з базою даних та репозиторії:

- `__init__.py` — Ініціалізаційний файл пакету.
- `database.py` — Налаштування з’єднання з базою даних.
- Директорія `/repositories`:
  - `__init__.py` — Ініціалізаційний файл пакету.
  - `base_repository.py` — Базовий клас репозиторію з CRUD-операціями.
  - `log_repository.py` — Репозиторій для логів.
  - `logs_collection_repository.py` — Репозиторій для колекцій логів.
  - `metrics_repository.py` — Репозиторій для метрик.
  - `project_repository.py` — Репозиторій для проєктів.
  - `question_repository.py` — Репозиторій для запитань.
  - `service_repository.py` — Репозиторій для сервісів.
  - `user_repository.py` — Репозиторій для користувачів.

#### `/app/models`

Моделі бази даних:

- `__init__.py` — Ініціалізаційний файл пакету.
- `log.py` — Моделі логів.
- `user.py` — Моделі користувачів.

#### `/app/schemas`

Схеми Pydantic для валідації даних:

- `__init__.py` — Ініціалізаційний файл пакету.
- `analysis.py` — Схеми для результатів аналізу.
- `log.py` — Схеми для логів.
- `metrics.py` — Схеми для метрик.
- `project.py` — Схеми для проєктів.
- `question.py` — Схеми для запитань.
- `service.py` — Схеми для сервісів.
- `service_test_item.py` — Схеми для елементів тестування сервісів.
- `service_tests.py` — Схеми для тестів сервісів.
- `test.py` — Схеми для тестових даних.
- `test_item.py` — Схеми для тестових елементів.
- `user.py` — Схеми для користувачів.

#### `/app/services`

Сервіси з бізнес-логікою:

- `__init__.py` — Ініціалізаційний файл пакету.
- `auth_service.py` — Сервіси для автентифікації.
- `log_service.py` — Сервіси для управління логами.
- `metrics_service.py` — Збір та аналіз метрик.
- `project_service.py` — Управління проєктами.
- `service_logs_service.py` — Логи для конкретних сервісів.
- `service_manager.py` — Управління мікросервісами.
- `service_service.py` — Операції з сервісами.
- `test_analyzer_service.py` — Аналіз тестів.
- `test_service.py` — Виконання та керування тестами.

#### `/app/utils`

Допоміжні утиліти:

- `__init__.py` — Ініціалізаційний файл пакету.
- `logger.py` — Утиліти для логування.

### Директорія `/tests`

Містить тести для застосунку:

- Юніт-тести
- Інтеграційні тести
- API тести

### Директорія `/docs`

Файли документації:

- Додаткова документація, окрім цього README.

## Архітектура

Застосунок дотримується багаторівневої архітектури:

1. **API-рівень** (`/app/api`) — Обробка HTTP-запитів та відповідей  
2. **Сервісний рівень** (`/app/services`) — Бізнес-логіка  
3. **Рівень репозиторіїв** (`/app/db/repositories`) — Доступ до даних  
4. **Рівень моделей** (`/app/models`) — Моделі бази даних  
5. **Рівень схем** (`/app/schemas`) — Валідація даних та DTO

Застосунок використовує ін’єкцію залежностей для слабкого зв’язування між компонентами, що реалізовано у файлі `dependencies.py`.
